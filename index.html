<!DOCTYPE html>
<html>
  <head>
    <title>Visit Submission</title>
    <script>
      async function submitVisit(event) {
        event.preventDefault();

        const formData = {
          repName: document.getElementById("repName").value,
          visitType: document.getElementById("visitType").value,
          personName: document.getElementById("personName").value,
          accountName: document.getElementById("accountName").value,
          contactNumber: document.getElementById("contactNumber").value,
          specialty: document.getElementById("specialty").value,
          prescribingStatus: document.getElementById("prescribingStatus").value,
          pharmacyStock: document.getElementById("pharmacyStock").value,
          movementLevel: document.getElementById("movementLevel").value,
          latitude: "",
          longitude: ""
        };

        try {
          const response = await fetch("https://script.google.com/macros/s/AKfycbz1O5B2dIfFaWUCy5lgeE1YqfjJi_AylnEGAeKWpPj-5t6BEyK1Rlupzd7V9xHNeDPgOw/exec", {
            method: "POST",
            body: JSON.stringify(formData),
            headers: {
              "Content-Type": "application/json",
            },
          });

          const result = await response.json();
          alert(result.status === "success" ? "Submitted successfully!" : "Error: " + result.message);
        } catch (err) {
          alert("Submission failed: " + err.message);
        }
      }
    </script>
  </head>
  <body>
    <h1>Visit Report Form</h1>
    <form onsubmit="submitVisit(event)">
      <label>Full Name:<br><input id="repName" required /></label><br><br>
      <label>Visit Type:<br><input id="visitType" required /></label><br><br>
      <label>Doctor/Pharmacist/Person Name:<br><input id="personName" required /></label><br><br>
      <label>Account Name:<br><input id="accountName" required /></label><br><br>
      <label>Contact Number:<br><input id="contactNumber" required /></label><br><br>
      <label>Specialty:<br><input id="specialty" required /></label><br><br>
      <label>Prescribing Status:<br><input id="prescribingStatus" required /></label><br><br>
      <label>Pharmacy Stock:<br><input id="pharmacyStock" /></label><br><br>
      <label>Movement Level:<br><input id="movementLevel" /></label><br><br>
      <button type="submit">Submit Visit</button>
    </form>
  </body>
</html>
